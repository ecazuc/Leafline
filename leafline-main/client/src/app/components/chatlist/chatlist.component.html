<html>

<head>

</head>

  <body >

  

        <ul class="list">

           
            
            <h1> <span class="title">Conversations</span>
                
                <div *ngIf="showInputField" class="new-conversation-input">
                    <input class="input-field" type="text" placeholder="username@domain" [(ngModel)]="newConversationUsername" (keyup.enter)="addConversation()" />
                </div>

                <button class="button-plus" mat-icon-button  (click)="toggleInputField()">
                    <mat-icon class="plus">
                        <svg width="14" height="14" viewBox="0 0 13 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g filter="url(#filter0_d_22_2608)">
                            <path d="M5.98554 0.00010571C5.91984 0.00104885 5.85508 0.00827938 5.79126 0.0221118C5.72713 0.0356298 5.6652 0.0554352 5.60484 0.0815281C5.5448 0.107307 5.4879 0.138744 5.43383 0.176154C5.38007 0.21325 5.33008 0.255376 5.2845 0.302217C5.23892 0.349059 5.19837 0.399987 5.16284 0.455002C5.127 0.510017 5.09714 0.567862 5.07293 0.628535C5.04873 0.689524 5.03081 0.752084 5.01886 0.81653C5.00692 0.880976 5.00157 0.945737 5.0022 1.01144V5.00208H1.01163C0.945615 5.00114 0.879912 5.00679 0.815152 5.01874C0.750079 5.03069 0.686891 5.04923 0.625589 5.07376C0.564288 5.09859 0.505816 5.12909 0.450487 5.16524C0.395473 5.20139 0.344231 5.24289 0.297076 5.2891C0.249921 5.33563 0.208111 5.38624 0.171015 5.44094C0.13392 5.49564 0.102798 5.55349 0.0770198 5.61448C0.0515561 5.67546 0.0323797 5.73834 0.0194907 5.80341C0.00628737 5.86817 0 5.93356 0 5.99958C0 6.06591 0.00628737 6.1313 0.0194907 6.19606C0.0323797 6.26082 0.0515561 6.3237 0.0770198 6.38469C0.102798 6.44567 0.13392 6.50352 0.171015 6.55853C0.208111 6.61323 0.249921 6.66385 0.297076 6.71006C0.344231 6.75659 0.395473 6.79777 0.450487 6.83424C0.505816 6.87039 0.564288 6.90089 0.625589 6.92541C0.686891 6.95024 0.750079 6.96848 0.815152 6.98074C0.879912 6.99268 0.945615 6.99834 1.01163 6.9974H5.0022V10.988C5.00126 11.0541 5.00692 11.1198 5.01918 11.1848C5.03112 11.2496 5.04967 11.3128 5.07419 11.3741C5.09871 11.4354 5.1292 11.4939 5.16567 11.5492C5.20182 11.6045 5.24301 11.6558 5.28953 11.7026C5.33606 11.7498 5.38667 11.7919 5.44137 11.829C5.49607 11.8658 5.55391 11.8972 5.6149 11.9227C5.67589 11.9481 5.73876 11.9673 5.80352 11.9805C5.86828 11.9934 5.93398 12 6 12C6.06602 12 6.13172 11.9934 6.19648 11.9805C6.26124 11.9673 6.32411 11.9481 6.3851 11.9227C6.44609 11.8972 6.50393 11.8658 6.55863 11.829C6.61333 11.7919 6.66394 11.7498 6.71047 11.7026C6.75699 11.6558 6.79818 11.6045 6.83433 11.5492C6.87079 11.4939 6.90129 11.4354 6.92581 11.3741C6.95033 11.3128 6.96888 11.2496 6.98082 11.1848C6.99308 11.1198 6.99874 11.0541 6.9978 10.988V6.9974H10.9884C11.0544 6.99834 11.1201 6.99268 11.1848 6.98074C11.2499 6.96848 11.3131 6.95024 11.3744 6.92541C11.4357 6.90089 11.4942 6.87039 11.5495 6.83424C11.6045 6.79777 11.6558 6.75659 11.7029 6.71006C11.7501 6.66385 11.7919 6.61323 11.829 6.55853C11.8661 6.50352 11.8972 6.44567 11.923 6.38469C11.9484 6.3237 11.9676 6.26082 11.9805 6.19606C11.9937 6.1313 12 6.06591 12 5.99958C12 5.93356 11.9937 5.86817 11.9805 5.80341C11.9676 5.73834 11.9484 5.67546 11.923 5.61448C11.8972 5.55349 11.8661 5.49564 11.829 5.44094C11.7919 5.38624 11.7501 5.33563 11.7029 5.2891C11.6558 5.24289 11.6045 5.20139 11.5495 5.16524C11.4942 5.12909 11.4357 5.09859 11.3744 5.07376C11.3131 5.04923 11.2499 5.03069 11.1848 5.01874C11.1201 5.00679 11.0544 5.00114 10.9884 5.00208H6.9978V1.01144C6.99843 0.944479 6.99277 0.878461 6.98051 0.813072C6.96825 0.747368 6.94939 0.68355 6.92424 0.621934C6.89909 0.560002 6.86828 0.501529 6.83118 0.445885C6.7944 0.390241 6.75228 0.338999 6.70512 0.291843C6.65797 0.244687 6.60673 0.202561 6.55108 0.16578C6.49544 0.128998 6.43666 0.0978754 6.37472 0.07304C6.31311 0.0478903 6.24929 0.0293422 6.1839 0.0170818C6.1182 0.00450692 6.05218 -0.000837426 5.98554 0.00010571Z" fill="#D4A373"/>
                            </g>
                            <defs>
                            <filter id="filter0_d_22_2608" x="0" y="0" width="13.1" height="13.1" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                            <feFlood flood-opacity="0" result="BackgroundImageFix"/>
                            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
                            <feOffset dx="0.7" dy="0.7"/>
                            <feGaussianBlur stdDeviation="0.2"/>
                            <feComposite in2="hardAlpha" operator="out"/>
                            <feColorMatrix type="matrix" values="0 0 0 0 0.75868 0 0 0 0 0.552949 0 0 0 0 0.351417 0 0 0 1 0"/>
                            <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_22_2608"/>
                            <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_22_2608" result="shape"/>
                            </filter>
                            </defs>
                            </svg>
                    </mat-icon>
                </button>

            </h1>



             <div>

               <div class="search-bar" [ngClass]="{'active': isInputFocused}">
                     <img class="lens" [src]="'/assets/images/loupe.svg'" alt="Search image">       
                  
                    
                    <input class="search-input" type="text" placeholder="Search a conversation" [(ngModel)]="searchQuery" (keyup.enter)="searchConv()" (focus)="onInputFocus()" (blur)="onInputBlur()">
                   
                    <button class="clear-button" *ngIf="searchQuery" matSuffix mat-icon-button aria-label="Clear" (click)="clearSearch()">
                        <mat-icon>close</mat-icon>
                    </button> 
                </div>
             

         
            </div> 

           

            <div class="scrollable-container" #scrollableContainer>

          
                <li class="item" *ngFor="let conversation of filteredConversations" [class.selected]="conversation.isSelected" (click)="selectConversation(conversation)" >
                    <img class="img-profil" [src]="'/assets/images/' + conversation.picture" alt="Profile Picture" >
                    <div class="info">
                        <div class="conversation-name" [ngStyle]="{'font-weight': (conversation.newMessage) ? 'bold' : 'normal'}"> 
                            {{ conversation.with }} 
                            <svg class="ping" *ngIf="conversation.newMessage" width="5" height="5" viewBox="0 0 5 5" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <circle cx="2.5" cy="2.5" r="2.5" fill="#98ED0F"/>
                            </svg>
                        </div>
                       
                        <div class="conversation-last" *ngIf="conversation.messages.length !=0">
                           <p *ngIf="isFromCurrentUser(conversation.messages[conversation.messages.length -1]) "> 
                            you : {{conversation.messages[conversation.messages.length -1].body}}
                           </p> 
                           <p *ngIf="!isFromCurrentUser(conversation.messages[conversation.messages.length -1])"> 
                           {{justLogin(conversation.messages[conversation.messages.length -1].from)}} : {{conversation.messages[conversation.messages.length -1].body}}
                           </p> 
                        </div>
                    </div>
                        <button class="delete-button" *ngIf="conversation.isSelected" matSuffix mat-icon-button aria-label="Delete" (click)="deleteConversation()">
                            <mat-icon>close</mat-icon>
                        </button> 
                       
                     
                    
    

                
              
               
            </div>
            
        </ul>
        
    </body>
  
</html>

